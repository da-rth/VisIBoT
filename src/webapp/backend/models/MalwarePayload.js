const { Schema, model } = require("mongoose")

const schema = new Schema(
  {
    _id: String,
    occurrences: Number,
    scan_url: String,
    hostname: String,
    ip_address: {
      type: Schema.Types.String,
      ref: "IpGeoData",
      required: true,
    },
    keyword: String,
    lisa: {
      type: Schema.Types.String,
      ref: "LisaAnalysis",
      required: false,
    },
    is_self_hosted: Boolean,
    candidate_C2s: [{ type: Schema.Types.String, ref: "IpGeoData" }],
    candidate_P2Ps: [{ type: Schema.Types.String, ref: "IpGeoData" }],
    created_at: Date,
    updated_at: Date,
  },
  {}
)

const MalwarePayload = model("MalwarePayload", schema, "malware_payload")

module.exports = MalwarePayload
